nodejs-server1:
  image: '{DOCKER_ID_USER}/node-service1'
  ports:
    - "4001:4001"
  volumes:
    - {USER_PATH}/log:/app/log
  links:
    - mongodb:mongodb
  environment:
    - NODE_ENV=production
    - LOG_DIR=./log/
    - SERVER_PORT=4001
    - SERVER_NAME=service1
nodejs-server2:
  image: '{DOCKER_ID_USER}/node-service2'
  ports:
    - "4002:4002"
  volumes:
    - {USER_PATH}/log:/app/log
  links:
    - mongodb:mongodb
  environment:
    - NODE_ENV=production
    - LOG_DIR=./log/
    - SERVER_PORT=4002
    - SERVER_NAME=service2
nodejs-server3:
  image: '{DOCKER_ID_USER}/node-service3'
  ports:
    - "4003:4003"
  volumes:
    - {USER_PATH}/log:/app/log
  links:
    - mongodb:mongodb
  environment:
    - NODE_ENV=production
    - LOG_DIR=./log/
    - SERVER_PORT=4003
    - SERVER_NAME=service3
mongodb:
  image: 'mongo:3.2'
  ports:
    - '27018:27017'
    - '28018:28017'
  volumes:
    - {USER_PATH}/mongodb:/var/log/mongodb
    - {USER_PATH}/mongodb_dir:/data/db
logstash:
  image: 'logstash'
  command: logstash -f /var/www/logstash.conf
  volumes:
   - {USER_PATH}/key:/key
   - {USER_PATH}/log:/log
   - {USER_PATH}/logstash:/var/www